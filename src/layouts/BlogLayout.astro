---
import BaseHead from '../components/BaseHead.astro';
import { getLangFromUrl } from '../i18n/utils';
import Header from "../components/Header.astro";
import { getAllTags } from "../utils/getAllTags";

const tags = await getAllTags();

const lang = getLangFromUrl(Astro.url);

/* interface Props {
	title: string;
}

const {title} = Astro.props; */


var regex = /\/(es|en)\//;
var resultLang = regex.test(Astro.url.pathname);

var regex1 = /.+\/blog$/;
var resultBlog = regex1.test(Astro.url.pathname);

var resultBlogFinal = (resultLang || resultBlog);

var regex2 = /blog\/\d+/;
var resultBlogDigit = regex2.test(Astro.url.pathname);

var regex3 = /\/blog\/tag\//;
var resultBlogTag = regex3.test(Astro.url.pathname);

---

<!DOCTYPE html>
<html lang={lang}>
	<head>
		<BaseHead title='Blog' description='Notas de la fundaciÃ³n' />
	</head>
<body>

    <Header />

    <main data-pagefind-ignore class="container mx-auto py-10">

		<section id="search" class="w-full mx-auto">
			<div id="search"></div>
		</section>

		<section id="tags">

			<!-- {
				tags.map((tag) => (
				  <span class="border-extra-soft-white mt-4 self-start rounded border px-2 py-1 text-zinc-400">
					<a href={`${Astro.url.pathname !== '/en/blog' && Astro.url.pathname !== '/es/blog' ? '../tag/' + tag.toLowerCase() : 'blog/tag/' + tag.toLowerCase()}`}>{tag}</a>
				  </span>
				))
			} -->
			{
				tags.map((tag) => (
					<span class="border-extra-soft-white mt-4 self-start rounded border px-2 py-1 text-zinc-400">

							{
                            (Astro.url.pathname === '/en/blog' || Astro.url.pathname === '/es/blog')
                                ? <a href={`./blog/tag/${tag.toLowerCase()}`}>{tag}</a>
                                : (/blog\/\d+/).test(Astro.url.pathname)
                                    ? <a href={`../blog/tag/${tag.toLowerCase()}`}>{tag}</a>
                                    : resultBlogTag
                                        ? <a href={`../tag/${tag.toLowerCase()}`}>{tag}</a>
                                        : null 
                            }

						{/* <a href={resultBlog ? `./blog/tag/${tag.toLowerCase()}` : `../tag/${tag.toLowerCase()}`}>{tag}</a> */}
						{/* <a href={resultBlog ? `./blog/tag/${tag.toLowerCase()}` : resultBlogDigit ? `../blog/tag/${tag.toLowerCase()}` : `../tag/${tag.toLowerCase()}`}>{tag}</a> */}
						{/* {resultBlog && <a href={`./blog/tag/${tag.toLowerCase()}`}>{tag}</a>} */}
						{/* {resultBlogDigit && <a href={`../blog/tag/${tag.toLowerCase()}`}>{tag}</a>} */}
						{/* {resultBlogTag && <a href={`../tag/${tag.toLowerCase()}`}>{tag}</a>} */}
					</span>
				))
			}
		</section>

		<!-- âœ… Grid Section - Starts Here ðŸ‘‡ -->
		<section class="bg-white py-6 sm:py-8 lg:py-12">

			<div class="mx-auto max-w-screen-2xl px-4 md:px-8">

				<slot />

			</div>

		</section>


    </main>

    <script>
        // Ejecutar la funciÃ³n setupSidebar() cada vez que ocurre una transiciÃ³n de pÃ¡gina
        document.addEventListener('astro:page-load', () => {
            // @ts-ignore
            let search = new PagefindUI({ 
                element: "#search", 
				pageSize: 1,
				excerptLength: 15,
                showSubResults: true,
				showImages: true,
				sort: { date: "desc" }
            });
            search.destroy();
            // @ts-ignore
            search = new PagefindUI({ 
                element: "#search", 
				pageSize: 1,
				excerptLength: 15,
                showSubResults: true,
				showImages: true,
				sort: { date: "desc" }
            });
        });
    </script>

</body>
</html>

<style is:global>
	:root {
		--pagefind-ui-scale: .7;
		--pagefind-ui-primary: #034ad8;
		--pagefind-ui-text: #ce3636;
		--pagefind-ui-background: #ffffff;
		--pagefind-ui-border: #eeeeee;
		--pagefind-ui-tag: #eeeeee;
		--pagefind-ui-border-width: 2px;
		--pagefind-ui-border-radius: 8px;
		--pagefind-ui-image-border-radius: 8px;
		--pagefind-ui-image-box-ratio: 3 / 2;
		--pagefind-ui-font: sans-serif;
	}

</style>